#-----------------------------------------------------------------------
# Caso nao acesse a internet, tentar utilizar o DNS da Google
#-----------------------------------------------------------------------
sudo vim /etc/resolv.conf
nameserver 8.8.8.8

sudo apt update

#-----------------------------------------------------------------------
# Instalacao do JAVA
#-----------------------------------------------------------------------
apt install default-jre
apt install default-jdk

#-----------------------------------------------------------------------
# Instalacao do GIT
#-----------------------------------------------------------------------
sudo apt update
sudo apt install git

#----------------------------------------------------------------------
# Permissoes pasta /opt/Dev
#----------------------------------------------------------------------
sudo groupadd dashboard
sudo usermod -a -G dashboard eduardo
sudo usermod -a -G dashboard Administrator
sudo usermod -a -G dashboard postgres
cd /opt
sudo mkdir Dev
sudo chgrp -R dashboard /opt/Dev
sudo chmod g+rwx /opt/Dev
# Para efetivar permissoes
sudo reboot

#-----------------------------------------------------------------------
# Instalacao do Maven
#-----------------------------------------------------------------------
wget https://www-eu.apache.org/dist/maven/maven-3/3.6.1/binaries/apache-maven-3.6.1-bin.tar.gz
tar -xvf apache-maven-3.6.1-bin.tar.gz
vim ~/.bash_profile
export PATH=/opt/Dev/apache-maven-3.6.1/bin:$PATH
source  ~/.bash_profile

#-----------------------------------------------------------------------
# Obter Projetos Dashboard e ETL
#-----------------------------------------------------------------------
git clone https:/github.com/filosofisto/escola-social-etl.git
git clone https:/github.com/filosofisto/escola-social-dashboard-api.git
git clone https:/github.com/filosofisto/escola-social-dashboard-web.git
git clone https://github.com/filosofisto/escola-social-docs.git

#-----------------------------------------------------------------------
# Construir os Projetos Java
#-----------------------------------------------------------------------
cd escola-social-etl
mvn clean package -DskipTests

cd escola-social-api
mvn clean package -DskipTests

#-----------------------------------------------------------------------
# Instalacao do NVM
#-----------------------------------------------------------------------
sudo apt update
sudo apt install build-essential libssl-dev
wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"
nvm install 10.16.0

#-----------------------------------------------------------------------
# Install Front
#-----------------------------------------------------------------------
cd ~/Dev/escola-social-web
npm install

#-----------------------------------------------------------------------
# Install Postgres
#-----------------------------------------------------------------------
sudo apt update
sudo apt install postgresql postgresql-contrib
sudo -i -u postgres

# Alterar a senha do usuario postgres
psql postgres posgres
\password postgres
Enter new password: socrates
Enter it again: socratescd

cd /opt/Dev/escola-social-docs
psql -f script.sql postgres

#-----------------------------------------------------------------------
# Variaveis de Ambiente
#-----------------------------------------------------------------------
vim ~/.bash_profile
export ESCOLA_SOCIAL_ETL_URL=jdbc:postgresql://localhost:5432/postgres
export ESCOLA_SOCIAL_ETL_USERNAME=escola_social_dev
export ESCOLA_SOCIAL_ETL_PASSWORD=12345678
export ESCOLA_SOCIAL_ETL_URL_ACCESS=jdbc:ucanaccess://D:/Users/filos/Documentos/EscolaSocial/database/SIC_be.accdb
